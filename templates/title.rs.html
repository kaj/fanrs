@use crate::models::{Article, CreatorSet, IssueRef, RefKeySet, Title};
@use crate::server::FullEpisode;
@use super::{epmisc, page};

@(title: &Title, articles: &[(Article, RefKeySet, CreatorSet, Vec<IssueRef>)], episodes: &[FullEpisode])
@:page(&title.title, {}, {
  @if !articles.is_empty() {
  <section>
    <h2>Artiklar</h2>
    @for (article, refs, creators, pubs) in articles {
    <div class="article">
      <h3>@article.title@if let Some(ref s) = article.subtitle {: @s}</h3>
      @refs
      @creators
      @if let Some(ref note) = article.note { <p class="info note">@note</p> }
      @if let Some((last_pub, pubs)) = pubs.split_last()
      {<p class="info pub">Publicerad i: @for p in pubs {@p, }@last_pub.</p>}
    </div>
    }
  </section>
  }
  <section>
    <h2>Episoder</h2>
    @for fe in episodes {
    <section class="episode">
      <h3>@if let Some(ref h) = fe.episode.episode {@h} else {@title.title}</h3>
      @:epmisc(&fe)
    </section>
    }
  </section>
})
